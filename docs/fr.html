<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR" xml:lang="fr-FR" >

<head>
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<meta name="author" content="Guillaume Brioudes https://myllaume.fr/" />
<meta name="author" content="Arthur Perret https://www.arthurperret.fr/" />
<meta name="dcterms.date" content="2021-08-31" />
<title>Documentation de Cosma</title>

<link rel="stylesheet" href="style.css" />

</head>

<body>


<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#presentation"><span class="toc-section-number">1</span> PrÃ©sentation</a></li>
<li><a href="#installation"><span class="toc-section-number">2</span> Installation</a></li>
<li><a href="#configuration"><span class="toc-section-number">3</span> Configuration</a>
<ul>
<li><a href="#parametres-requis"><span class="toc-section-number">3.1</span> ParamÃ¨tres requis</a></li>
<li><a href="#parametres-du-graphe"><span class="toc-section-number">3.2</span> ParamÃ¨tres du graphe</a></li>
<li><a href="#parametres-facultatifs"><span class="toc-section-number">3.3</span> ParamÃ¨tres facultatifs</a></li>
</ul></li>
<li><a href="#utilisation-du-cosmographe"><span class="toc-section-number">4</span> Utilisation du cosmographe</a>
<ul>
<li><a href="#format-de-donnees"><span class="toc-section-number">4.1</span> Format de donnÃ©es</a></li>
<li><a href="#creer-des-fiches-via-cosma"><span class="toc-section-number">4.2</span> CrÃ©er des fiches via Cosma</a></li>
<li><a href="#creer-des-liens"><span class="toc-section-number">4.3</span> CrÃ©er des liens</a></li>
<li><a href="#bibliographie"><span class="toc-section-number">4.4</span> Bibliographie</a></li>
<li><a href="#export"><span class="toc-section-number">4.5</span> Export</a></li>
<li><a href="#historique"><span class="toc-section-number">4.6</span> Historique</a></li>
<li><a href="#alertes-et-erreurs"><span class="toc-section-number">4.7</span> Alertes et erreurs</a></li>
</ul></li>
<li><a href="#utilisation-du-cosmoscope"><span class="toc-section-number">5</span> Utilisation du cosmoscope</a>
<ul>
<li><a href="#description-generale-de-linterface"><span class="toc-section-number">5.1</span> Description gÃ©nÃ©rale de lâ€™interface</a></li>
<li><a href="#graphe"><span class="toc-section-number">5.2</span> Graphe</a></li>
<li><a href="#fiches"><span class="toc-section-number">5.3</span> Fiches</a></li>
<li><a href="#mode-focus"><span class="toc-section-number">5.4</span> Mode focus</a></li>
<li><a href="#moteur-de-recherche"><span class="toc-section-number">5.5</span> Moteur de recherche</a></li>
<li><a href="#filtrer-laffichage-par-types"><span class="toc-section-number">5.6</span> Filtrer lâ€™affichage par types</a></li>
<li><a href="#mots-cles"><span class="toc-section-number">5.7</span> Mots-clÃ©s</a></li>
<li><a href="#index"><span class="toc-section-number">5.8</span> Index</a></li>
<li><a href="#vues"><span class="toc-section-number">5.9</span> Vues</a></li>
<li><a href="#personnalisation-de-linterface"><span class="toc-section-number">5.10</span> Personnalisation de lâ€™interface</a></li>
</ul></li>
<li><a href="#developpement"><span class="toc-section-number">6</span> DÃ©veloppement</a></li>
</ul>
</nav>

<main>
<article>
<h1 class="title">Documentation de Cosma</h1>
<p>Cosma est un logiciel de visualisation de graphe documentaire. Il permet de reprÃ©senter des notes interreliÃ©es sous la forme dâ€™un rÃ©seau interactif dans une interface web. Le logiciel est conÃ§u pour fonctionner avec des fichiers texte en Markdown et sâ€™adapte aussi bien Ã  une petite collection (centaine de documents) quâ€™Ã  une vaste documentation (jusquâ€™Ã  plusieurs milliers de documents).</p>
<p>Cosma est dÃ©veloppÃ© dans le cadre du programme de recherche ANR <a href="https://hyperotlet.hypotheses.org/">HyperOtlet</a>.</p>
<div class="sommaire">
<ol>
<li><a href="#presentation">PrÃ©sentation</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#utilisation-du-cosmographe">Utilisation du cosmographe</a></li>
<li><a href="#utilisation-du-cosmoscope">Utilisation du cosmoscope</a></li>
<li><a href="#developpement">DÃ©veloppement</a></li>
<li><a href="#credits">CrÃ©dits</a></li>
</ol>
</div>
<h1 data-number="1" id="presentation"><span class="header-section-number">1</span> PrÃ©sentation</h1>
<p>Cosma est un logiciel de visualisation de graphe documentaire. Il permet de reprÃ©senter des notes interreliÃ©es sous la forme dâ€™un rÃ©seau interactif dans une interface web. Cosma nâ€™est pas lui-mÃªme un logiciel de prise de notesÂ : il est pensÃ© pour fonctionner en complÃ©mentaritÃ© avec ces logiciels et nÃ©cessite que les notes soient structurÃ©es suivant un format bien prÃ©cis.</p>
<p>La plupart des outils de visualisation concentrent leurs fonctionnalitÃ©s dans une application Ã  interface graphique, Ã  partir de laquelle il est possible dâ€™exporter des donnÃ©es structurÃ©es ou des images statiques. Cosma inverse cette logiqueÂ : la partie application, surnommÃ©e <strong>cosmographe</strong>, est un simple formulaire de crÃ©ation, et câ€™est lâ€™export, un fichier HTML surnommÃ© <strong>cosmoscope</strong>, qui constitue la vÃ©ritable interface de visualisation. Ce fichier autonome contient un graphe interactif, des outils de navigation interne (index, moteur de recherche, filtres) et le texte intÃ©gral des fichesÂ ; il inclut aussi les donnÃ©es sources au format JSON et peut Ãªtre utilisÃ© hors connexion.</p>
<p>Cosma est conÃ§u pour laisser un degrÃ© Ã©levÃ© de contrÃ´le Ã  ses utilisateurs.</p>
<p>PremiÃ¨rement, le logiciel fonctionne avec un rÃ©pertoire de fichiers au format texte quâ€™il se contente de lireÂ : utiliser ou dÃ©sinstaller le logiciel nâ€™altÃ©rera pas vos fichiers et vous permet donc de mettre en Å“uvre les pratiques de stockage, de versionnement et dâ€™Ã©dition de votre choix. De cette maniÃ¨re, si le logiciel sâ€™envole les donnÃ©es restent.</p>
<p>DeuxiÃ¨mement, de nombreux Ã©lÃ©ments dâ€™interface sont personnalisablesÂ : algorithme de dessin de rÃ©seau, couleurs des nÅ“uds, tracÃ© des liens, raccourcis vers des vues particuliÃ¨res, etc.</p>
<p>TroisiÃ¨mement, des enrichissements documentaires (mÃ©tadonnÃ©es) et sÃ©mantiques (qualification des liens) sont possibles et se font par des mÃ©canismes gÃ©nÃ©riquesÂ : lâ€™utilisateur est libre dâ€™appliquer les typologies et ontologies de son choix.</p>
<p>Et quatriÃ¨mement, Cosma est un logiciel qui se veut modulaire, interopÃ©rable et portable mais surtout libreÂ : le code est public, son dÃ©veloppement est documentÃ©, il est accessible et rÃ©utilisable gratuitement sous licence MIT. Le travail peut ainsi Ãªtre Ã©valuÃ©, archivÃ© et continuÃ© par dâ€™autres.</p>
<h1 data-number="2" id="installation"><span class="header-section-number">2</span> Installation</h1>
<p><a href="https://github.com/graphlab-fr/cosma/releases/latest">Cliquez ici</a> pour consulter la page dÃ©diÃ©e Ã  la version la plus rÃ©cente de Cosma. Vous pouvez y lire les notes de version et tÃ©lÃ©charger le logiciel dans la version qui correspond Ã  votre systÃ¨me dâ€™exploitation (fichier <code>.app</code> pour macOS, <code>.exe</code> pour Windows).</p>
<h1 data-number="3" id="configuration"><span class="header-section-number">3</span> Configuration</h1>
<h2 data-number="3.1" id="parametres-requis"><span class="header-section-number">3.1</span> ParamÃ¨tres requis</h2>
<dl>
<dt><code>files_origin</code></dt>
<dd>Chemin du rÃ©pertoire contenant les fichiers Markdown Ã  lire.
</dd>
<dd>ExempleÂ : <code>/Users/user/Fiches/'</code>, <code>D:\repertoire\</code>
</dd>
<dt><code>export_target</code></dt>
<dd>Chemin du rÃ©pertoire oÃ¹ exporter le cosmoscope.
</dd>
<dd>ExempleÂ : <code>./'</code>, <code>D:\repertoire\</code>
</dd>
<dt><code>record_types</code></dt>
<dd>Liste des types de fiches. Chaque type est dÃ©fini par un nom et une couleur.
</dd>
<dt><code>link_types</code></dt>
<dd>Liste des types de relations. Chaque type est dÃ©fini par un nom, une couleur et un type de trait.
</dd>
</dl>
<div class="important">
<p>Le type par dÃ©faut <code>undefined</code> doit obligatoirement Ãªtre dÃ©fini, que ce soit pour les types de fiches ou pour les types de liens.</p>
</div>
<div class="astuce">
<p>La configuration des relations a une incidence sur leur lisibilitÃ© au sein du graphe. Prenons un exempleÂ : un utilisateur dÃ©finit trois types de liens qualifiÃ©s Ã  la maniÃ¨re dâ€™un thÃ©saurus (spÃ©cifique <code>s</code>, gÃ©nÃ©rique <code>g</code> et associÃ© <code>a</code>). Il choisit les couleurs et types de traits de maniÃ¨re Ã  renforcer la visibilitÃ© des liens qualifiÃ©sÂ : les liens non qualifiÃ©s (<code>undefined</code>) sont en pointillÃ©s (<code>dotted</code>) gris (<code>grey</code>), tandis que les liens qualifiÃ©s sont plus lisibles, grÃ¢ce Ã  des traits continus (<code>simple</code>) et une couleur plus foncÃ©e (<code>black</code>).</p>
</div>
<h2 data-number="3.2" id="parametres-du-graphe"><span class="header-section-number">3.2</span> ParamÃ¨tres du graphe</h2>
<p>La plupart des paramÃ¨tres du graphe peuvent Ãªtre modifiÃ©s en direct dans lâ€™interface du cosmoscope (voir <a href="#graphe">Graphe</a> plus bas). Vous pouvez tester diffÃ©rentes valeurs avant de les reporter dans la configuration. Ce sont les valeurs dÃ©finies dans la configuration qui sont rÃ©tablies Ã  chaque rechargement du cosmoscope.</p>
<dl>
<dt><code>background_color</code></dt>
<dd>Couleur de fond du graphe.
</dd>
<dd>ExempleÂ : <code>whitesmoke</code> ,<code>#ccc</code>, <code>rgb(57, 57, 57)</code>
</dd>
<dt><code>highlight_color</code></dt>
<dd>Couleur de surbrillance des Ã©lÃ©ments mis en sÃ©lection.
</dd>
<dd>ExempleÂ : <code>red</code> ,<code>#0642ff</code>, <code>rgb(207, 52, 118)</code>
</dd>
<dt><code>highlight_on_hover</code></dt>
<dd>Survoler un nÅ“ud le met temporairement en surbrillance, ainsi que ses connexions.
</dd>
<dt><code>text_size</code></dt>
<dd>Taille des Ã©tiquettes des nÅ“uds. Lâ€™unitÃ© implicite est le pixel. La valeur minimale est <code>5</code>Â ; la valeur maximale est <code>15</code>.
</dd>
<dt><code>attraction</code></dt>
<dd>ParamÃ¨tres de la simulation de forces entre les nÅ“uds.
</dd>
<dd><code>force</code>Â : puissance globale. Plus elle est faible, plus les liens entre les nÅ“uds sont relÃ¢chÃ©s. Une valeur infÃ©rieure Ã  <code>50</code> tend Ã  provoquer des collisions incessantes.
</dd>
<dd><code>distance_max</code>Â : distance maximum entre les nÅ“uds et Ã®lots. Au-delÃ  de <code>1000</code>, ce paramÃ¨tre nâ€™a pas dâ€™effet mesurable. La valeur de <code>distance_max</code> indique Ã©galement la valeur maximale effective de <code>force</code>. Par exemple, si <code>distance_max: 500</code>, alors augmenter <code>force</code> au-delÃ  de 500 nâ€™aura pas dâ€™incidence.
</dd>
<dd><code>verticale</code>Â : force dâ€™attraction vers lâ€™axe vertical. Une valeur de <code>0</code> signifie que ce paramÃ¨tre est dÃ©sactivÃ©e.
</dd>
<dd><code>horizontale</code>Â : force dâ€™attraction vers lâ€™axe horizontal. Une valeur de <code>0</code> signifie que ce paramÃ¨tre est dÃ©sactivÃ©e.
</dd>
<dt><code>arrows</code></dt>
<dd>Affichage des flÃ¨ches. Permet dâ€™obtenir un graphe orientÃ© ou non orientÃ©.
</dd>
</dl>
<h2 data-number="3.3" id="parametres-facultatifs"><span class="header-section-number">3.3</span> ParamÃ¨tres facultatifs</h2>
<p>Vous pouvez ajouter Ã  la configuration les paramÃ¨tres suivantsÂ :</p>
<dl>
<dt><code>bibliography</code></dt>
<dd>Chemin vers le fichier (JSON CSL) <code>.json</code> contenant la liste des rÃ©fÃ©rences bibliographiques. Permet dâ€™activer la <a href="#bibliographie">bibliographie des fiches</a>.
</dd>
<dt><code>csl</code></dt>
<dd>Chemin vers le fichier de style (CSL) <code>.csl</code> contenant les styles de citation. Permet dâ€™activer la <a href="#bibliographie">bibliographie des fiches</a>.
</dd>
<dt><code>minify</code></dt>
<dd>RÃ©duit le poids du fichier <code>cosmoscope.html</code>, au dÃ©triment de la lisibilitÃ© du code source. DÃ©sactivÃ© par dÃ©faut.
</dd>
<dt><code>custom_css</code></dt>
<dd>Applique les styles dÃ©clarÃ©s par lâ€™utilisateur dans un fichier CSS dont il indique le chemin. DÃ©sactivÃ© par dÃ©faut.
</dd>
<dt><code>history</code></dt>
<dd>Exporte une copie du cosmoscope et de ses donnÃ©es dans un sous-dossier horodatÃ© du dossier <code>history</code>. ActivÃ© par dÃ©faut.
</dd>
<dt><code>metadata</code></dt>
<dd>Liste de mÃ©tadonnÃ©es utilisÃ©es pour le partage du cosmoscope.
</dd>
<dt><code>focus_max</code></dt>
<dd>Valeur maximale du focus. La valeur doit un entier supÃ©rieur ou Ã©gal Ã  <code>0</code>.
</dd>
<dt><code>views</code></dt>
<dd>Liste des vues apparaissant dans la section Vues du cosmoscope. Chaque vue est dÃ©finie par une paire <code>nom: valeur</code> dans laquelle <code>nom</code> correspond au nom de la vue et <code>valeur</code> correspond Ã  une chaÃ®ne de caractÃ¨res gÃ©nÃ©rÃ©e via le bouton Sauvegarder la vue actuelle du cosmoscope.
</dd>
<dt><code>link_symbol</code></dt>
<dd>DÃ©finir un ou plusieurs caractÃ¨res venant remplacer dans les fiches le texte des hyperliens (identifiant de la fiche cible).
</dd>
</dl>
<h1 data-number="4" id="utilisation-du-cosmographe"><span class="header-section-number">4</span> Utilisation du cosmographe</h1>
<h2 data-number="4.1" id="format-de-donnees"><span class="header-section-number">4.1</span> Format de donnÃ©es</h2>
<p>Cosma ne prescrit pas de logiciel dâ€™Ã©criture, mais son fonctionnement repose sur lâ€™adoption simultanÃ©e de plusieurs normes dâ€™Ã©criture qui visent Ã  accroÃ®tre lâ€™interopÃ©rabilitÃ© et la pÃ©rennitÃ© des donnÃ©esÂ :</p>
<ul>
<li>YAML pour la configuration du logiciel et les mÃ©tadonnÃ©es des fichiersÂ ;</li>
<li>Markdown pour le contenu des fichiersÂ ;</li>
<li>une syntaxe de type wiki (doubles crochets <code>[[ ]]</code>) pour crÃ©er des liens internesÂ ;</li>
<li>des identifiants uniques qui servent de cibles aux liens internes.</li>
</ul>
<p>Cette combinaison de normes dâ€™Ã©criture correspond au croisement de plusieurs cultures textuellesÂ : documentationÂ ; wikisÂ ; prise de notes avec la mÃ©thode ZettelkastenÂ ; Ã©criture acadÃ©mique avec Pandoc. Cosma fonctionne donc particuliÃ¨rement bien lorsquâ€™il est utilisÃ© en tandem avec des environnements dâ€™Ã©criture qui partagent cette approche, comme <a href="https://zettlr.com">Zettlr</a> ou lâ€™extension <a href="https://foambubble.github.io/foam/">Foam</a> pour Visual Studio Code et VSCodium.</p>
<p>Pour Ãªtre correctement interprÃ©tÃ©s par Cosma, les fichiers Markdown doivent donc respecter une certaine structure, et notamment la prÃ©sence dâ€™un en-tÃªte YAML au dÃ©but du fichier.</p>
<p>ExempleÂ :</p>
<pre><code>---
title: Titre du document
id: 20201209111625
type: undefined
tags:
- mot-clÃ© 1
- mot-clÃ© 2
---</code></pre>
<p>Lâ€™en-tÃªte YAML est dÃ©limitÃ© par deux sÃ©ries de trois tirets seuls sur une ligne (<code>---</code>). Cosma reconnaÃ®t et utilise les quatre champs suivantsÂ :</p>
<dl>
<dt><code>title</code></dt>
<dd>Titre de la fiche. Obligatoire.
</dd>
<dt><code>id</code></dt>
<dd>Identifiant unique de la fiche. Obligatoire. Par dÃ©faut, Cosma gÃ©nÃ¨re des identifiants Ã  14 chiffres par horodatage (annÃ©e, mois, jour, heures, minutes et secondes) sur le modÃ¨le de certains logiciels de prise de notes type Zettelkasten comme <a href="https://zettelkasten.de/the-archive/">The Archive</a> ou <a href="https://www.zettlr.com">Zettlr</a>.
</dd>
<dt><code>type</code></dt>
<dd>Type de la fiche. Facultatif. Une fiche ne peut Ãªtre assignÃ©e quâ€™Ã  un seul type. Si le champ <code>type</code> nâ€™est pas spÃ©cifiÃ© ou bien que sa valeur ne correspond Ã  lâ€™un des types enregistrÃ©s dans la configuration sous le paramÃ¨tre <code>record_types</code>, Cosma interprÃ¨tera le type de la fiche comme <code>undefined</code>.
</dd>
<dt><code>tags</code></dt>
<dd>Mots-clÃ©s de la fiche. Facultatif. La valeur doit Ãªtre une liste. Une fiche peut disposer dâ€™autant de mot-clÃ©s que vous souhaitez.
</dd>
</dl>
<p>ConformÃ©ment Ã  la spÃ©cification YAML, la liste des mots-clÃ©s peut Ãªtre inscrite en mode <em>block</em>Â :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tags</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> mot-clÃ© 1</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> mot-clÃ© 2</span></span></code></pre></div>
<p>Ou bien en mode <em>flow</em>Â :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tags</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">mot-clÃ©</span><span class="dv"> 1</span><span class="kw">,</span><span class="at"> mot-clÃ©</span><span class="dv"> 2</span><span class="kw">]</span></span></code></pre></div>
<p>Vous pouvez ajouter des champs supplÃ©mentaires de maniÃ¨re arbitraire, par exemple un champ <code>description</code>.</p>
<p>AprÃ¨s lâ€™entÃªte, vous pouvez librement inscrire votre contenu.</p>
<div class="important">
<p>Le rendu des fichiers Markdown sous forme de fiche HTML dans le cosmoscope est limitÃ© aux Ã©lÃ©ments textuels. Les images par exemple ne sont pas incluses et seront remplacÃ©es par leur texte alternatif le cas Ã©chÃ©ant.</p>
</div>
<h2 data-number="4.2" id="creer-des-fiches-via-cosma"><span class="header-section-number">4.2</span> CrÃ©er des fiches via Cosma</h2>
<p>Vous pouvez crÃ©er un fichier Markdown conforme pour Cosma Ã  la main ou bien en utilisant le formulaire inclus dans lâ€™application. Seul le titre est obligatoire.</p>
<h2 data-number="4.3" id="creer-des-liens"><span class="header-section-number">4.3</span> CrÃ©er des liens</h2>
<p>Ã€ lâ€™intÃ©rieur des fiches, vous pouvez crÃ©er des liens avec lâ€™identifiant de la fiche cible entre double crochets. Le cosmographe reconnaÃ®t ces liens et les utilise pour modÃ©liser la structure du graphe.</p>
<p>ExempleÂ :</p>
<pre><code>Un lien vers [[20201209111625]] une fiche.</code></pre>
<p>Vous pouvez Ã©galement qualifier le lien selon la typologie indiquÃ©e sous <code>link_types</code> dans la configuration. Le type de lien est alors ajoutÃ© comme prÃ©fixe Ã  lâ€™identifiant, avec un deux-points comme sÃ©parateur.</p>
<p>ExempleÂ :</p>
<pre><code>Le concept B dÃ©rive du [[gÃ©nÃ©rique:20201209111625]] concept A.</code></pre>
<div class="astuce">
<p>Utilisez lâ€™option <code>link_symbol</code> pour allÃ©ger visuellement les liens lorsque vous affichez les fiches dans le cosmoscope. La valeur donnÃ©e au paramÃ¨tre peut Ãªtre nâ€™importe quelle chaÃ®ne de caractÃ¨re (exemple : â˜) et remplacera les 14 chiffres entre les crochets.</p>
</div>
<h2 data-number="4.4" id="bibliographie"><span class="header-section-number">4.4</span> Bibliographie</h2>
<p>Cosma intÃ¨gre une fonctionnalitÃ© de traitement des citations qui repose sur le mÃªme Ã©cosystÃ¨me que Zettlr (donnÃ©es et styles au format CSL, syntaxe de Pandoc).</p>
<p>Installez lâ€™extension <a href="https://retorque.re/zotero-better-bibtex/">Better BibTeX</a> pour <a href="https://www.zotero.org/">Zotero</a> afin de gÃ©nÃ©rer des clÃ©s uniques pour chaque rÃ©fÃ©rence. Vous pouvez Ã©galement exporter une collection dans un fichier texte maintenu Ã  jour par cette mÃªme extension. Exportez vos donnÃ©es bibliographiques au format CSL JSON et renseignez le fichier dans la configuration de Cosma.</p>
<p>Vous pouvez intÃ©grer les clÃ©s de citation au sein de vos fiches en utilisant la syntaxe de Pandoc :</p>
<pre><code>On sait queâ€¦ [@ledeuff2014, 22; @perret2020].</code></pre>
<p>Cliquez sur Nouveau cosmoscope avec citations pour gÃ©nÃ©rer un cosmoscope avec le traitement des citations activÃ©. Chaque clÃ© de citation est alors remplacÃ©e par du texte formatÃ© et une bibliographie est gÃ©nÃ©rÃ©e en-dessous du corps de chaque fiche contenant des rÃ©fÃ©rences.</p>
<pre><code>On sait queâ€¦ (Le Deuff 2014, p. 22; Perret 2020).

Bibliographie
-------------

LE DEUFF, Olivier, 2014. Le temps de humanitÃ©s digitales. FYP. ISBN 978-2-36405-155-5.

PERRET, Arthur, 2020. Fonction documentaire de preuve et donnÃ©es numÃ©riques. www.arthurperret.fr [en ligne]. 9 septembre 2020. [ConsultÃ© le 14 septembre 2020]. Disponible Ã  lâ€™adresse : https://www.arthurperret.fr/fonction-documentaire-preuve-donnees-numeriques.html</code></pre>
<p>Vous pouvez modifier le style de citation (par dÃ©faut : ISO690-author-date-fr) en indiquant un fichier de style CSL dans la configuration. TÃ©lÃ©chargez des styles depuis la <a href="https://www.zotero.org/styles">base de donnÃ©es de Zotero</a>.</p>
<p>Vous pouvez modifier la traduction des mots-clÃ©s de la notice bibliographique (par dÃ©faut : franÃ§ais) en remplaÃ§ant le fichier <code>/template/citeproc/locales.xml</code>. TÃ©lÃ©chargez une nouvelle traduction depuis la <a href="https://github.com/citation-style-language/locales/tree/6b0cb4689127a69852f48608b6d1a879900f418b">base de donnÃ©e CSL</a>.</p>
<p>Les donnÃ©es correspondant aux rÃ©fÃ©rences citÃ©es sont enregistrÃ©es dans le cosmoscope au format JSON. Vous pouvez retrouver et tÃ©lÃ©charger ces donnÃ©es en cliquant sur le lien Â«Â DonnÃ©esÂ Â», au bas du menu. Dans le code source du cosmoscope, elles se situent sous la balise <code>&lt;article id="citation-references"&gt;</code>.</p>
<h2 data-number="4.5" id="export"><span class="header-section-number">4.5</span> Export</h2>
<p>Le partage intÃ¨gre au cosmoscope les mÃ©tadonnÃ©es <code>title</code>, <code>author</code> et <code>description</code> renseignÃ©es dans la <a href="#parametres-facultatifs">configuration (option <code>metas</code>)</a>. Si elle est renseignÃ©e, la mÃ©tadonnÃ©e <code>title</code> vient aussi remplacer la barre dâ€™outils en haut du menu gauche.</p>
<p>Le fichier <code>cosmoscope.html</code> est exportÃ© dans le rÃ©pertoire dÃ©fini par <code>export_target</code> dans la configuration. Si le fichier existe dÃ©jÃ  au mÃªme emplacement, il est Ã©crasÃ©.</p>
<h2 data-number="4.6" id="historique"><span class="header-section-number">4.6</span> Historique</h2>
<p>Si le paramÃ¨tre <code>history</code> a pour valeur <code>true</code>, cliquer sur Nouveau cosmoscope gÃ©nÃ¨re un sous-rÃ©pertoire horodatÃ© (selon la date dâ€™export, Ã  la seconde prÃ¨s) dans le rÃ©pertoire <code>/history</code> avec les contenus suivantsÂ : <!-- Ã  vÃ©rifier --></p>
<ul>
<li>une copie du fichier <code>cosmoscope.html</code>Â ;</li>
<li>un rÃ©pertoire <code>data</code> contenant les fichiers <code>links.json</code> et <code>nodes.json</code>, respectivement la liste des liens et des nÅ“uds, avec leurs mÃ©tadonnÃ©es respectives.</li>
</ul>
<p>Cet export facilite le partage des donnÃ©es et leur rÃ©utilisation dans dâ€™autres logiciels de visualisation.</p>
<h2 data-number="4.7" id="alertes-et-erreurs"><span class="header-section-number">4.7</span> Alertes et erreurs</h2>
<p>Durant le processus dâ€™analyse de vos fichiers Markdown, il se peut que des conflits avec le systÃ¨me surviennent (sans interrompre le processus dâ€™export). Il y a alors deux types de notificationÂ :</p>
<ul>
<li>certaines donnÃ©es doivent Ãªtre remplacÃ©es (type non reconnu, lien sans cibleâ€¦), vous recevez alors une <strong>alerte</strong> (<em>warning</em>)Â ;</li>
<li>certaines informations empÃªchent le traitement dâ€™un fichier (manque dâ€™un titre, identifiant non uniqueâ€¦), vous recevez alors une <strong>erreur</strong> (<em>error</em>).</li>
</ul>
<p>Les alertes peuvent Ãªtre ignorÃ©es. Vous devez corriger toutes les erreurs pour que le cosmoscope soit complet par rapport Ã  votre bibliothÃ¨que.</p>
<p>Les alertes (en jaune) et erreurs (en rouge) sont affichÃ©es dans la console. Au-delÃ  de 5 notifications par type, seul leur nombre est annoncÃ©. Vous pouvez les lire dans un fichier <code>error.log</code>. Le cas Ã©chÃ©ant, il est enregistrÃ© dans un sous-rÃ©pertoire horodatÃ© (selon la date dâ€™export, Ã  la seconde prÃ¨s), dans le rÃ©pertoire <code>history</code>.</p>
<h1 data-number="5" id="utilisation-du-cosmoscope"><span class="header-section-number">5</span> Utilisation du cosmoscope</h1>
<p>Le fichier <code>cosmoscope.html</code> peut Ãªtre lu avec un navigateur web depuis votre ordinateur. Il peut aussi Ãªtre mis en ligne, par exemple dÃ©posÃ© sur un serveur web par un simple envoi FTP. Ceci permet Ã©ventuellement de le partager largement. Vous pouvez notamment envoyer un lien vers une fiche en particulier sur un cosmoscope en ligne, en ajoutant son identifiant prÃ©cÃ©dÃ© dâ€™un croisillon <code>#</code> en fin dâ€™URL. ExempleÂ :</p>
<p><code>https://domaine.fr/cosmoscope.html#20210427185546</code></p>
<h2 data-number="5.1" id="description-generale-de-linterface"><span class="header-section-number">5.1</span> Description gÃ©nÃ©rale de lâ€™interface</h2>
<p>Lâ€™interface de Cosma est organisÃ©e en trois colonnesÂ :</p>
<dl>
<dt>Panneau latÃ©ral gauche (Menu)</dt>
<dd>Regroupe les fonctionnalitÃ©s permettant de chercher de lâ€™information et de modifier lâ€™affichage de maniÃ¨re globale.
</dd>
<dt>Zone centrale (Graphe)</dt>
<dd>Affiche le graphe et les contrÃ´les associÃ©s (zoom, focus).
</dd>
<dt>Panneau latÃ©ral droit (Fiche)</dt>
<dd>Affiche les fiches (mÃ©tadonnÃ©es et contenu) ainsi quâ€™une liste des liens sortants (Liens) et entrants (RÃ©troliens).
</dd>
</dl>
<p><a href="https://hyperotlet.huma-num.fr/cosma/img/cosma-interface-schema.png"><img src="https://hyperotlet.huma-num.fr/cosma/img/cosma-interface-schema.png" alt="Interface de Cosma (cliquez sur lâ€™image pour lâ€™afficher en grand)" /></a></p>
<h2 data-number="5.2" id="graphe"><span class="header-section-number">5.2</span> Graphe</h2>
<p>Le graphe situÃ©e dans la zone centrale de lâ€™interface affiche des nÅ“uds Ã©tiquetÃ©s et interreliÃ©s. Chaque nÅ“ud correspond Ã  une ficheÂ ; lâ€™Ã©tiquette correspond au titre de la fiche. Les liens correspondent aux liens Ã©tablis entre les fiches via leur identifiant entre doubles crochets.</p>
<p>Si le <a href="#parametres-du-graphe">paramÃ¨tre <code>highlight_on_hover</code> est activÃ©</a>, survoler un nÅ“ud le met temporairement en <strong>surbrillance</strong>, ainsi que ses connexions. Cliquer sur un nÅ“ud le met en surbrillance, ainsi que ses connexions, et ouvre la fiche correspondante.</p>
<p>Vous pouvez <strong>zoomer</strong> librement dans le graphe Ã  la souris, au pavÃ© tactile, en double cliquant sur le fond du graphe ou bien avec les boutons dÃ©diÃ©s situÃ©s en bas Ã  gauche. Appuyez sur la touche <code>C</code> pour zoomer sur un nÅ“ud sÃ©lectionnÃ©. Le bouton Recentrer (raccourciÂ : touche <code>R</code>) rÃ©initialise le zoom.</p>
<p>Les nÅ“uds sont organisÃ©s dans lâ€™espace par un algorithme de simulation de forces. Une barre colorÃ©e sous le logo Cosma tÃ©moigne de lâ€™Ã©tat de la simulation. Cliquez dessus (raccourciÂ : touche <code>Espace</code>) pour lancer un cycle de simulation supplÃ©mentaire.</p>
<div class="astuce">
<p>Quelques pressions sur la touche <code>Espace</code> permettent de Â«Â dÃ©plierÂ Â» progressivement un graphe emmÃªlÃ©.</p>
</div>
<p>Le graphe nâ€™est pas figÃ©, les nÅ“uds peuvent donc Ãªtre dÃ©placÃ©s par cliquer-glisser. Ils restent soumis en permanence Ã  la simulation, donc il nâ€™est pas possible de les disposer manuellement de maniÃ¨re arbitraire.</p>
<p>Lâ€™affichage du graphe peut Ãªtre modifiÃ© de maniÃ¨re temporaire via les contrÃ´les placÃ©s sous ParamÃ¨tres du graphe dans le panneau latÃ©ral gaucheÂ :</p>
<ul>
<li>affichage des liensÂ ;</li>
<li>affichage des Ã©tiquettesÂ ;</li>
<li>animation des nÅ“uds au survolÂ ;</li>
<li>forces simulÃ©es par lâ€™algorithme de dessin du grapheÂ ;</li>
<li>position du graphe dans lâ€™espaceÂ ;</li>
<li>taille des Ã©tiquettes.</li>
</ul>
<p>Pour modifier lâ€™affichage de maniÃ¨re permanente, modifiez les valeurs par dÃ©faut des paramÃ¨tres correspondants sous <code>graph_config</code> dans <code>config.yml</code> (voir <a href="#parametres-du-graphe">ParamÃ¨tres du graphe</a> plus haut).</p>
<div class="astuce">
<p>Modifiez <code>force</code> et <code>distance_max</code> pour adapter lâ€™affichage Ã  la rÃ©solution et la taille de votre Ã©cran. Modifiez <code>verticale</code> et <code>horizontale</code> pour appliquer une force centripÃ¨te vers lâ€™axe correspondant, ce qui permet notamment de ramener les Ã®lots et nÅ“uds isolÃ©s plus prÃ¨s du centre.</p>
</div>
<p>Lâ€™affichage est possible sur tous types dâ€™Ã©crans mais nâ€™est pas optimisÃ© pour les terminaux mobilesÂ : le tactile ne donne pas accÃ¨s Ã  certaines interactions comme le survol, et les petits Ã©crans restreignent lâ€™utilitÃ© du graphe.</p>
<h2 data-number="5.3" id="fiches"><span class="header-section-number">5.3</span> Fiches</h2>
<p>Les fiches peuvent Ãªtres ouvertes en cliquant sur un nÅ“ud, une entrÃ©e de lâ€™index, une suggestion du moteur de recherche, ou un lien dans le corps dâ€™une fiche. Ouvrir une fiche affiche son contenu dans le panneau latÃ©ral droit. Cela met aussi Ã  jour lâ€™URL de la page avec lâ€™identifiant de la ficheÂ : ceci permet de naviguer entre les fiches visitÃ©es via les fonctionnalitÃ©s PrÃ©cÃ©dent / Suivant du navigateur, mais aussi de les retrouver dans lâ€™historique ou encore dâ€™obtenir un lien direct vers la fiche.</p>
<p>Cliquer sur le bouton Â«Â FermerÂ Â» referme le volet et dÃ©sÃ©lectionne le nÅ“ud correspondant dans le graphe.</p>
<p>Les liens prÃ©sents dans les fiches sont cliquables. Vous pouvez ouvrir ces liens dans un nouvel onglet via un clic droit. Le titre du lien (affichÃ© en infobulle aprÃ¨s 1-2 secondes de survol) est celui de la fiche correspondante.</p>
<div class="astuce">
<p>Vous pouvez remplacer depuis la configuration le texte contenu dans les liens par un ou plusieurs caractÃ¨res. Lâ€™option <code>link_symbol</code> vous permet de remplacer tout les identifiants contenu dans les liens par un symbole ou un texte comme par exemple <code>â˜</code>.</p>
</div>
<p>En bas de la fiche se trouve une liste des fiches vers lesquelles elle renvoie (liens sortants), ainsi que des fiches qui pointent vers elles (liens entrants ou rÃ©troliens). Les liens et rÃ©troliens sont contextualisÃ©sÂ : au survol, une infobulle sâ€™affiche, montrant le paragraphe dans lequel ce lien se trouve dans la fiche correspondante.</p>
<h2 data-number="5.4" id="mode-focus"><span class="header-section-number">5.4</span> Mode focus</h2>
<p>Le bouton Activer le focus (raccourciÂ : touche <code>F</code>) situÃ© en bas Ã  gauche du graphe permet de restreindre lâ€™affichage au nÅ“ud sÃ©lectionnÃ©Â : en mode focus, seules les connexions directes Ã  la fiche sÃ©lectionnÃ©e sont affichÃ©es dans lâ€™interface. Le mode focus ne fonctionne que si vous avez sÃ©lectionnÃ© une fiche.</p>
<p>Une fois le mode focus activÃ©, vous zoomez automatiquement sur le nÅ“ud sÃ©lectionnÃ©.</p>
<p>Le curseur qui apparaÃ®t sous le bouton Activer le focus permet de faire varier la distance dâ€™affichage, jusquâ€™au maximum permis par le paramÃ¨tre <code>focus_max</code> dans la configuration.</p>
<div class="astuce">
<p>Le curseur du niveau de focus est contrÃ´lable via les flÃ¨ches du clavier. Vous pouvez enchaÃ®ner les raccourcisÂ : <code>F</code> pour activer le focus, puis les flÃ¨ches pour augmenter le niveau de focus.</p>
</div>
<h2 data-number="5.5" id="moteur-de-recherche"><span class="header-section-number">5.5</span> Moteur de recherche</h2>
<p>Le champ de texte situÃ© en haut du panneau latÃ©ral gauche est un moteur de recherche. Il suggÃ¨re une liste de fiches dont le titre est proche de votre saisie (<em>fuzzy search</em>). Cliquer sur une suggestion sÃ©lectionne le nÅ“ud correspondant dans le graphe et ouvre la fiche correspondante dans le panneau latÃ©ral de droite.</p>
<div class="important">
<p>Les suggestions disponibles sont contraintes par les filtres et le mode focusÂ : une fiche masquÃ©e par lâ€™une lâ€™autre de ces fonctionnalitÃ©s ne sera pas accessible via le moteur de recherche.</p>
</div>
<h2 data-number="5.6" id="filtrer-laffichage-par-types"><span class="header-section-number">5.6</span> Filtrer lâ€™affichage par types</h2>
<p>La liste des types de fiches situÃ©e en haut du panneau latÃ©ral gauche permet de filtrer lâ€™affichage. Cliquer sur un type permet de masquer et rÃ©afficher les fiches du type correspondant dans le graphe, lâ€™index et les suggestions du moteur de recherche. Cliquer sur un type en maintenant la touche <code>Alt</code> enfoncÃ©e permet de masquer et rÃ©afficher les fiches des autres types.</p>
<p>Pour quâ€™un type apparaisse, il doit Ãªtre dÃ©clarÃ© sous <code>record_types</code> dans la configuration et Ãªtre prÃ©sent dans au moins une fiche.</p>
<h2 data-number="5.7" id="mots-cles"><span class="header-section-number">5.7</span> Mots-clÃ©s</h2>
<p>La liste des mots-clÃ©s situÃ©e dans le panneau latÃ©ral gauche permet de mettre en Ã©vidence les fiches qui utilisent chaque mot-clÃ©. SÃ©lectionner un mot-clÃ© met en surbrillance lâ€™Ã©tiquette des nÅ“uds correspondants dans le graphe et restreint lâ€™index aux fiches correspondantes. Vous pouvez activer simultanÃ©ment plusieurs mots-clÃ©s. Pour dÃ©sactiver un mot-clÃ©, cliquez Ã  nouveau sur le bouton correspondant.</p>
<p>Pour quâ€™un mot-clÃ© apparaisse, il suffit quâ€™il ait Ã©tÃ© dÃ©clarÃ© dans au moins une fiche via le champ <code>tags</code>.</p>
<h2 data-number="5.8" id="index"><span class="header-section-number">5.8</span> Index</h2>
<p>Lâ€™index alphabÃ©tique des fiches situÃ© dans le panneau latÃ©ral gauche permet dâ€™accÃ©der directement Ã  une fiche sans passer par le graphe. Cliquer sur un titre sÃ©lectionne le nÅ“ud correspondant dans le graphe et ouvre la fiche correspondante. Lâ€™index peut Ãªtre triÃ© par ordre alphabÃ©tique croissant ou dÃ©croissant. Les filtres, les mots-clÃ©s et le mode focus modifient lâ€™affichage de lâ€™index.</p>
<h2 data-number="5.9" id="vues"><span class="header-section-number">5.9</span> Vues</h2>
<p>Ã€ tout moment, lâ€™Ã©tat du graphe (fiche sÃ©lectionnÃ©e, filtres actifs, mode focus) peut Ãªtre sauvegardÃ© pour un accÃ¨s rapide. Cette fonctionnalitÃ© est une sorte de marque-page mais pour le graphe. Cliquez sur le bouton Sauvegarder la vue et indiquez un nom. Ceci ajoute un bouton Ã©ponyme dans la section Vues du panneau latÃ©ral gauche. Cliquer sur ce bouton applique tous les paramÃ¨tres qui Ã©taient actifs au moment de lâ€™enregistrement de la vue. Cliquer Ã  nouveau sur le bouton rÃ©tablit lâ€™affichage normal.</p>
<h2 data-number="5.10" id="personnalisation-de-linterface"><span class="header-section-number">5.10</span> Personnalisation de lâ€™interface</h2>
<p>Lâ€™interface peut Ãªtre personnalisÃ©e via un fichier CSS. Les dÃ©clarations faites dans ce fichier remplacent celles prÃ©sentes dans <code>/template/styles.css</code> et <code>/template/print.css</code> (pour les styles Ã  lâ€™impression). Elles sâ€™appliquent au fichier <code>/template/template.njk</code>. Consultez ces fichiers pour connaÃ®tre les sÃ©lecteurs Ã  utiliser pour telle ou telle dÃ©claration. Vous pouvez aussi utiliser lâ€™inspecteur de votre navigateur web, et celui de lâ€™application Cosma en activant lâ€™affichage des outils de dÃ©veloppement. Les feuilles de style du cosmoscope utilisent notamment des variables CSS pour dÃ©finir les couleurs et les polices utilisÃ©es. Vous pouvez redÃ©finir uniquement ces variables pour modifier tous les Ã©lÃ©ments dâ€™interface auxquels elles sâ€™appliquent.</p>
<p>Dans lâ€™exemple ci-dessous, le fichier <code>custom.css</code> contient des dÃ©clarations qui modifient les polices utilisÃ©es dans le cosmoscopeÂ :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">:root</span> {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="va">--sans</span>: <span class="st">&quot;IBM Plex Sans&quot;</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="va">--serif</span>: <span class="st">&quot;IBM Plex Serif&quot;</span><span class="op">,</span> <span class="dv">serif</span><span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="va">--mono</span>: <span class="st">&quot;IBM Plex Mono&quot;</span><span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="va">--condensed</span>: <span class="st">&#39;Avenir Next Condensed&#39;</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h1 data-number="6" id="developpement"><span class="header-section-number">6</span> DÃ©veloppement</h1>
<p>ğŸš§ En construction ğŸš§</p>
<!-- 
Cette partie de la documentation s'adresse Ã  des dÃ©veloppeurs expÃ©rimentÃ©s en JavaScript. Elle prÃ©sente l'arborescence et les concepts sur lesquels reposent les deux parties formant Cosma, le **cosmographe** et le **cosmoscope**.

Nous vous recommandons vivement de lire le reste de la documentation pour bien saisir l'ensemble des usages en jeu dans le code source prÃ©sentÃ© ci-dessous.

## Terminologie

Les fichiers Markdown interprÃ©tÃ©s par Cosma sont qualifiÃ©s ici de Â«Â fichesÂ Â» plutÃ´t que de Â«Â notesÂ Â», en rÃ©fÃ©rence Ã  la tradition de la fiche Ã©rudite et Ã  l'histoire de la documentation. L'acception documentaire de Â«Â ficheÂ Â» n'a pas de traduction directe en anglais (sinon *index card*). En revanche, elle est conceptuellement proche du mot Â«Â *record*Â Â» issu du [*records management*](https://fr.wikipedia.org/wiki/Records_management). Le code de Cosma emploie donc le mot record pour dÃ©signer une fiche.

## Description gÃ©nÃ©rale de l'architecture

Cosma est principalement implÃ©mentÃ© en JavaScript. Le logiciel repose sur deux systÃ¨mes distincts, le cosmographe et le cosmoscope.

Le **cosmographe** repose sur l'environnement Node.js. Une sÃ©rie de scripts permettent deÂ :

- vÃ©rifier et actualiser le fichier de configurationÂ ;
- gÃ©nÃ©rer des fichiers Markdown et leur entÃªteÂ ;
- lire un rÃ©pertoire pour en extraire les fichiers Markdown et analyser leur contenu (Markdown, mÃ©tadonnÃ©es YAML et liens style wiki) afin de gÃ©nÃ©rerÂ :
    - des fichiers JSONÂ ;
    - le cosmoscope (ses donnÃ©es et variables CSS).

Le **cosmoscope** est un fichier HTML exÃ©cutÃ© sur navigateurs web, crÃ©Ã© Ã  partir d'un *template* [Nunjucks](https://mozilla.github.io/nunjucks/) (`template.njk`). Il intÃ¨greÂ :

- les mÃ©tadonnÃ©es web et styles issus de la configurationÂ ;
- les scripts et bibliothÃ¨ques JavaScriptÂ ;
- des index (mots-clÃ©s, titre de fiche, vues)Â ;
- les fiches.

## Arborescence

Vous trouverez ci-dessous une description complÃ¨te de l'arborescence du logiciel. Vous pourrez ainsi distinguer les fichiers concernant le cosmographe et ceux du cosmoscope.

```
.
â”œâ”€â”€ docs/                   | rÃ©pertoire de la documentation
â”‚   â”œâ”€â”€ api/                | rÃ©pertoire des index des API
â”‚   â”‚   â””â”€â”€ [x].md          | introduction Ã  l'index [x] de l'API
â”‚   â””â”€â”€ api-config-[x].json | config. de l'index [x] de l'API
â”œâ”€â”€ functions/              | fonctions du cosmographe
â”‚   â”œâ”€â”€ autorecord.js       | crÃ©ation de fichiers Markdown formatÃ©s
â”‚   â”œâ”€â”€ history.js          | crÃ©ation rÃ©pertoires de l'historique des exports
â”‚   â”œâ”€â”€ links.js            | analyse des liens wiki et de leurs attributs
â”‚   â”œâ”€â”€ log.js              | affichage des alertes et crÃ©ation des registres
â”‚   â”œâ”€â”€ modelize.js         | analyse des fichiers Markdown et crÃ©ation modÃ¨le de donnÃ©es
â”‚   â”œâ”€â”€ record.js           | formulaire du terminal pour crÃ©ation des fichiers Md
â”‚   â”œâ”€â”€ template.js         | intÃ©gration donnÃ©es, style et corps du cosmoscope
â”‚   â””â”€â”€ verifconfig.js      | validation et modification de la configuration
â”œâ”€â”€ template/               | 
â”‚   â”œâ”€â”€ libs/               | bibliothÃ¨ques JavaScript
â”‚   â”œâ”€â”€ scripts/            | fonctions du cosmoscope
â”‚   â”‚   â”œâ”€â”€ bibliography.js | tÃ©lÃ©chargement des donnÃ©es bibliographiques
â”‚   â”‚   â”œâ”€â”€ counter.js      | actualiser les compteurs d'entitÃ©s
â”‚   â”‚   â”œâ”€â”€ filter.js       | appliquer filtres
â”‚   â”‚   â”œâ”€â”€ focus.js        | appliquer focus
â”‚   â”‚   â”œâ”€â”€ graph.js        | affichage du graphe et intÃ©ractions
â”‚   â”‚   â”œâ”€â”€ history.js      | historique de navigation entre les fiches
â”‚   â”‚   â”œâ”€â”€ index.js        | contrÃ´le des volets et boutons du menu gauche
â”‚   â”‚   â”œâ”€â”€ keyboard.js     | affectation des raccourcis clavier
â”‚   â”‚   â”œâ”€â”€ main.js         | variables globales et animation logo
â”‚   â”‚   â”œâ”€â”€ record.js       | ouvrir/fermer le volet latÃ©ral droit
â”‚   â”‚   â”œâ”€â”€ search.js       | paramÃ©trage moteur de recherche
â”‚   â”‚   â”œâ”€â”€ tag.js          | appliquer tags
â”‚   â”‚   â”œâ”€â”€ view.js         | enregistrer et appliquer une vue
â”‚   â”‚   â””â”€â”€ zoom.js         | paramÃ©trer les dÃ©placement (latÃ©ral, zoom) au sein du graphe
â”‚   â”œâ”€â”€ cosmalogo.svg       | logo du logiciel
â”‚   â”œâ”€â”€ template.njk        | structure du cosmoscope
â”‚   â”œâ”€â”€ print.css           | styles d'impression du cosmoscope
â”‚   â””â”€â”€ styles.css          | styles du cosmoscope
â”œâ”€â”€ app.js                  | adressage des commandes du terminal
â””â”€â”€ package.json            | liste des dÃ©pendances Node.js
```

## Index des fonctions

Cliquez sur les liens ci-dessous pour consulter la liste des fonctions utilisÃ©es par le cosmographe et le cosmoscopeÂ :

- [Consulter l'API du cosmographe](./api/cosmographe/index.html)
- [Consulter l'API du cosmoscope](./api/cosmoscope/index.html)

## Fonctionnement du cosmographe

Il a trois utilisations possibles via le terminal. Ces diffÃ©rentes requÃªtes sont rÃ©ceptionnÃ©es par `app.js` qui les renvoieÂ :

- extraire et modÃ©liser (`modelize.js`) puis intÃ©grer (`template.js`) les donnÃ©es dans un cosmoscopeÂ ;
- gÃ©nÃ©rer des fichiers Markdown formatÃ©s (`record.js` et `autorecord.js`)Â ;
- modifier la configuration (`verifconfig.js`).

La configuration (le contenu du fichier `config.yml` devenu un objet JavaScript) est exportÃ©e de maniÃ¨re globale (depuis `verifconfig.js`). Elle peut Ãªtre appelÃ©e comme ci-dessous.

```javascript
const config = require('./verifconfig').config;

const folderToExport = config.export_target;
```

## Lecture des fichiers

Depuis le fichier `modelize.js`, on extrait de chaque fichier Markdown les mÃ©tadonnÃ©es (l'entÃªte YAML) et le contenu (suivant l'entÃªte YAML) (fichier `modelize.js`).

[`catchLinksFromContent()`](./api/cosmographe/global.html#catchLinksFromContent)
: Le contenu est lu une premiÃ¨re fois par une sÃ©rie d'expressions rÃ©guliÃ¨res pour en extraire les paragraphes, et pour chaque paragraphe les *wikilinks* contenus. Le paragraphe devient le contexte de ses liens et est transpilÃ© en HTML.

[`convertLinks()`](./api/cosmographe/global.html#convertLinks)
: Le contenu du fichier est ensuite transformÃ© pour y transformer les *wikilinks* en liens Markdown

[`cosmoscope()`](./api/cosmographe/global.html#cosmoscope)
: Le contenu du fichier est intÃ©gralement transpilÃ© du Markdown Ã  l'HTML.

La premiÃ¨re et la troisiÃ¨me fonction font appel Ã  la bibliothÃ¨que markdown-it. Elle peut Ãªtre remplacÃ©e.

## GÃ©nÃ©ration du cosmoscope

Le cosmoscope est gÃ©nÃ©rÃ© grÃ¢ce Ã  la fonction [`cosmoscope()`](./api/cosmographe/global.html#cosmoscope).

Celle-ci instancie le modÃ¨le Nunjucks `/template/template.njk` et y injecte les donnÃ©es relatives Ã  la configuration, aux fiches et aux entitÃ©s du graphe ainsi que leurs styles (sÃ©rialisÃ©s par la fonction [`colors()`](./api/cosmographe/global.html#colors)).

Nunjucks importe par ailleurs dans son `head` les fichiers de style CSS et les bibliothÃ¨ques JavaScript ainsi que les fonctions JavaScript dans des balises `script` en fin de document. Les donnÃ©es relatives aux fiches et Ã  la configuration sont intÃ©grÃ©es via des boucles et autres structures de contrÃ´le de Nunjucks.

Le tout est enregistrÃ© dans un fichier `cosmoscope.html` et est [exportÃ©](#export).

## Affichage du graphe

La gÃ©nÃ©ration et l'animation du graphe reposent sur la bibliothÃ¨que [D3.js](https://d3js.org/). Celle-ci perÃ§oit ses donnÃ©es depuis l'objet global `graph`. Cet object est composÃ© de deux tableaux.

`graph.nodes`
: Ce tableau contient toutes les donnÃ©es relatives aux nÅ“uds, y compris une sÃ©rie de boolÃ©ens permettant de connaÃ®tre leur Ã©tat d'affichage (voir la sÃ©rialisation par la fonction [`registerNodes()`](./api/cosmographe/global.html#registerNodes)). Cet Ã©tat indiquÃ© est actualisÃ© Ã  chaque modification d'affichage.

`graph.links`
: Ce tableau contient toutes les donnÃ©es relatives aux liens (voir la sÃ©rialisation par la fonction [`registerLinks()`](./api/cosmographe/global.html#registerLinks)).

## Affichage via d'autres bibliothÃ¨ques

Les tableaux prÃ©sentÃ©s dans la section prÃ©cÃ©dente peuvent Ãªtre injectÃ©s dans d'autres bibliothÃ¨ques JavaScript de gÃ©nÃ©ration de graphe.

**Exemple 1Â :** Vis.js Network ([dÃ©pÃ´t](https://github.com/visjs/vis-network), [exemple](https://github.com/visjs/vis-network#example)).

Extrait du fichier `/functions/modelize.js`Â :

```javascript
function registerLinks(file) {
// ...
  for (const link of file.links) {
  // ...
    entities.links.push({
      // ...
      from: Number(link.source.id),
      to: Number(link.target.id),
      // ...
    });
  }
}
```

Extrait du fichier `/template/scripts/graph.js`

```javascript
const network = new vis.Network(
  document.getElementById('network')
  , data = {
    nodes: new vis.DataSet(graph.nodes),
    edges: new vis.DataSet(graph.links)
  }
  , {  } // options
);
```

**Exemple 2Â :** Sigma.js ([dÃ©pÃ´t](https://github.com/jacomyal/sigma.js/), [exemple](https://github.com/jacomyal/sigma.js/blob/master/examples/basic.html#L70)).

```javascript
const network = new sigma({
  graph: {
    nodes: graph.nodes,
    edges: graph.links
  },
  container: 'network'
});
```

## ParamÃ¨tres du graphe

Les paramÃ¨tres du graphe sont extraits de la partie `graph_config` du fichier de configuration `config.yml`. Elle est injectÃ©e dans le modÃ¨le Nunjucks `/template/template.njk` via la fonction [`cosmoscope()`](./api/cosmographe/global.html#cosmoscope). Dans le modÃ¨le, elle est Ã  la fois utilisÃ©e comme valeur par dÃ©faut des formulaires du menu Â«Â ParamÃ¨tres du grapheÂ Â» et implÃ©mentÃ©e comme objet global JavaScript `graphProperties`.

Ce mÃªme objet global est actualisÃ© par les diffÃ©rents formulaires du menu Â«Â ParamÃ¨tres du grapheÂ Â». Ils font ensuite appel Ã  la fonction [`updateForces()`](./api/cosmographe/global.html#updateForces) pour relancer l'Ã©valuation de ces paramÃ¨tres par la bibliothÃ¨que de visualisation D3.js.

## Raccourcis clavier

L'ensemble des raccourcis clavier du cosmoscope sont implÃ©mentÃ©s dans le fichier `/template/scripts/keyboard.js`. L'objet global `pressedKeys` contient la liste des touches surveillÃ©es pour modifier un comportement. D'autres touches (des lettres) sont listÃ©es pour appeler certaines fonctions et ne sont pas ajoutÃ©es Ã  l'objet global `pressedKeys`.

Le boolÃ©en global `keyboardShortcutsAreWorking` dÃ©finit si les raccourcis peuvent Ãªtre utilisÃ©s ou non. Lors de la saisie dans un champ, il ne faut pas que les lettres servent Ã  autre chose qu'Ã©crire.

# CrÃ©dits

## Ã‰quipe

- [Arthur Perret](https://www.arthurperret.fr/) (porteur du projet)
- [Guillaume Brioudes](https://myllaume.fr/) (dÃ©veloppeur)
- [ClÃ©ment Borel](https://mica.u-bordeaux-montaigne.fr/borel-clement/) (chercheur)
- [Olivier Le Deuff](http://www.guidedesegares.info/) (chercheur)

## BibliothÃ¨ques utilisÃ©es

Pour amÃ©liorer la maintenabilitÃ© et la lisibilitÃ© du code source, lâ€™Ã©quipe de dÃ©veloppement a recouru aux bibliothÃ¨ques suivantes.

- [D3.js](https://d3js.org/) v4.13.0 (BSD 3-Clause)Â : GÃ©nÃ©ration du graphe
- [Nunjucks](https://mozilla.github.io/nunjucks/) v3.2.3 (BSD 2-Clause)Â : GÃ©nÃ©ration du template du Cosmoscope
- [Js-yaml](https://github.com/nodeca/js-yaml) v3.14.0 (MIT License)Â : Lecture du fichier de configuration et Ã©criture des YAML Front Matter
- [Js-yaml-front-matter](https://github.com/dworthen/js-yaml-front-matter) v4.1.0 (MIT License)Â : Lecture des YAML Front Matter des fichiers Markdown
- [Markdown-it](https://github.com/markdown-it/markdown-it) v12.0.2 (MIT License)Â : Conversion Markdown â†’ HTML
- [Markdown-it-attrs](https://www.npmjs.com/package/markdown-it-attrs) v4.0.0  (MIT License)Â : Traitement des hyperliens Markdown au sein des fiches
- [Citeproc-js](https://github.com/Juris-M/citeproc-js) v2.4.59 (CPAL et AGPL)Â : Conversion des clÃ©s de citation
- [Minify-html](https://github.com/wilsonzlin/minify-html) v0.4.3 (MIT License)Â : AllÃ¨gement du Cosmoscope
- [Fuse.js](https://fusejs.io/) v6.4.6 (Apache License 2.0)Â : Moteur de recherche
- [Moment](https://momentjs.com/) v2.29.1 (MIT License)Â : Gestion de l'horodatage
 -->
</article>
</main>



</body>

</html>